<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BoardMapper">

	<sql id="search">
		<if test="type != null and keyword != null">
			<where>
				<choose>
					<when test="type =='T'.toString()">
						 TITLE LIKE '%'||#{keyword}||'%'
					</when>
					<when test="type =='C'.toString()">
						 TEXT LIKE '%'||#{keyword}||'%'
					</when>
					<when test="type =='W'.toString()">
						 USERID LIKE '%'||#{keyword}||'%'
					</when>
				</choose>
			</where>
		</if>
	</sql>

	<delete id="boardDelete" parameterType="int">
		delete from board
		where
		board_num = #{board_num}
	</delete>
	<update id="boardUpdate" parameterType="Board">
		update board
		set
		title=#{title} , userid = #{userid}, text = #{text}
		where board_num =
		#{board_num}
	</update>
	<insert id="boardWrite" parameterType="Board">
		insert into board
		(board_num,title,userid,text,team_code)
		values (board_seq.nextval,
		#{title},#{userid},#{text},#{team_code})
	</insert>


	<select id="selectList" resultType="Board" parameterType="hashmap">
		<![CDATA[
		select board_num, title,
		userid, text, team_code,
		to_char(board_date, 'YYYY/MM/dd')
		as board_date,
		count
		from board
		]]>
		<include refid="search"></include>
		<if test="team_code != null">
			and team_code = #{tema_code}
		</if>
		<![CDATA[
		order by board_num desc
		]]>
	</select>

	<select id="totalCount" resultType="int" parameterType="hashmap">
		<![CDATA[
		select count(*)
		from board
		]]>
		<include refid="search"></include>
	</select>


	<update id="readCnt" parameterType="int">
		update board
		set count = count
		+ 1
		where board_num = #{board_num}
	</update>
	<select id="selectByNo" resultType="Board" parameterType="int">
		select
		board_num, title, userid, text,
		to_char(board_date, 'YYYY/MM/dd') as
		board_date,
		count
		from board
		where board_num = #{board_num}
	</select>



</mapper>


